---
title: "p8105_hw2_mk4208"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Loading required packages 

```{r}
library(tidyverse)
library(readxl)
```

## Problem 1 

Importing Mr. Trash Wheel sheet and omitting non-data entries. 
Rows that do not include dumpster-specific data have been omitted. 
Number of sports balls have been rounded the nearest integer and the result has been converted to a numeric variable. 

```{r}
trashwheel =
  read_excel(path="./Data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", 
                        sheet = 1,
                        range ="A2:N338") %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  mutate(sports_balls = round(sports_balls, digits = 0)) %>% 
  mutate(sports_balls = as.integer(sports_balls))
```

# Precipitation data for 2018:
Rows without precipitation data have been omitted. 
Year variable has been added.

```{r}
precipitation_2018 = 
  read_excel(path="./Data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", 
                        sheet = 3,
                        range ="A2:B14") %>% 
  janitor::clean_names()  %>%
  drop_na(total) %>% 
  mutate(year = 2018)
```

# Precipitation data for 2017: 
Rows without precipitation data have been omitted. 
Year variable has been added. 

```{r}
precipitation_2017 = 
  read_excel(path="./Data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", 
                        sheet = 4,
                        range ="A2:B14") %>% 
  janitor::clean_names()  %>%
  drop_na(total) %>% 
  mutate(year = 2017)
```

Precipitation data for 2018 and 2017 have been merged and month name has been converted to a character variable. 

```{r}
precipitation_full = full_join(precipitation_2017, precipitation_2018) %>% 
  mutate(month = month.name[month])
```

# Here is a short description of the 2 datasets: 
For the precipitation dataset, there are `r nrow(precipitation_full)` observations. It contains the following variables: `r colnames(precipitation_full)`.
The total precipitation in the year 2018 was `r sum(pull(precipitation_full, total))`. 

For the Mr. Trash Wheel dataset, there are `r nrow(trashwheel)` observations. It contains the following variables: `r colnames(trashwheel)`.
The median number of sports balls in a dumpster in 2017 was `r median(pull(filter(trashwheel, year == "2017"), sports_balls))`.

```{r}
pols = read_csv("./Data/fivethirtyeight_datasets/pols-month.csv") %>% 
  separate(mon,
    c("year", "month", "day"), 
    convert = TRUE) %>% 
  mutate(prez_dem = recode(prez_dem, '1' = "dem")) %>% 
  mutate(prez_gop = recode(prez_gop, '1' = "gop")) %>% 
  pivot_longer(
    c("prez_dem", "prez_gop"), 
    values_to = "president", 
    values_drop_na = TRUE
  ) %>% 
  mutate(month = month.name[month]) %>% 
  select(-day)

snp = read_csv("./Data/fivethirtyeight_datasets/snp.csv") %>% 
  separate(date, 
           c("month", "day", "year"),
           convert = TRUE) %>%
  mutate(month = month.name[month]) %>% 
  select(year, month, -day, everything())

unemployment = read_csv("./Data/fivethirtyeight_datasets/unemployment.csv") %>% 
  pivot_longer(Jan:Dec, 
    names_to = "month",
    values_to = "rate"
  ) %>% 
  mutate(month = match(month, month.abb)) %>% 
  mutate(month = month.name[month]) %>%
  mutate(Year = as.integer(Year)) %>%
  janitor::clean_names()

merged_data = pols %>% 
  left_join(snp, 
    by = c("year", "month") 
  ) %>% 
  left_join(
    unemployment,
    by = c("year", "month")
    )
```

Problem 3 

```{r}
popular_baby_names = read_csv("./Data/Popular_Baby_Names.csv") %>%
  janitor::clean_names() %>% 
  mutate(ethnicity = recode(ethnicity, "ASIAN AND PACI" = "ASIAN AND PACIFIC ISLANDER",
                            "WHITE NON HISP" = "WHITE NON HISPANIC",
                            "BLACK NON HISP" = "BLACK NON HISPANIC")) %>% 
  mutate(childs_first_name = str_to_lower(childs_first_name)) %>% 
  distinct()

olivia = popular_baby_names %>% 
  filter(childs_first_name == "olivia") %>% 
  select(-count) %>%
  pivot_wider(
    names_from = "year_of_birth",
    values_from = "rank"
  ) 

print(olivia)

most_popular_male = popular_baby_names %>% 
  filter(gender == "MALE") %>% 
  filter(rank == 1) %>%
  select(-count) %>% 
  pivot_wider(
    names_from = "year_of_birth",
    values_from = "childs_first_name"
  ) 

print(most_popular_male)
```

```{r}
scatterplot = popular_baby_names %>% 
  filter(gender ==  "MALE", 
         ethnicity == "WHITE NON HISPANIC", 
         year_of_birth == 2016) %>%
  group_by(childs_first_name) %>%
  ggplot(aes(x = rank, y = count)) +
  geom_point()

print(scatterplot) 
```



